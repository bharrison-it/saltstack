cloud_local_storage_percentused_default_levels = (80, 90)

def inventory_cloud_local_storage(info):
    inventory = []
    for line in info:
        zonename = line[0]
        inventory.append( (zonename, 'cloud_local_storage_percentused_default_levels') )
    return inventory

def check_cloud_local_storage(item, params, info):
    warn, crit = cloud_local_storage_percentused_default_levels
    for line in info:
        zonename = line[0]
        if zonename == item:
            percentused = float(line[2])
            capacityused = (int(line[3])/1024/1024/1024)
            capacitytotal = (int(line[4])/1024/1024/1024)

            if percentused > crit:
                STATE = 2
            elif percentused > warn:
                STATE = 1
            else:
                STATE = 0

            STATE_TXT = "{0:.2f}% used ( {1} of {2} GB),(levels at {3}/{4} %)".format(percentused, capacityused, capacitytotal, warn, crit)
            perfdata = [ ( "cloud memory percentused", percentused, warn, crit, 0, 100 ) ]
            return (STATE, STATE_TXT, perfdata)

check_info["cloud_local_storage"] = {
    "inventory_function"  : inventory_cloud_local_storage,
    "check_function"      : check_cloud_local_storage,
    "has_perfdata"        : True,
    "service_description" : "cloud local_storage percentused of %s"
}
